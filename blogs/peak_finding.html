<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js dark">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Thuật toán tìm đỉnh Peak Finding - TrL</title>
                

        <!-- Custom HTML head -->
        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> 

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
                <link rel="stylesheet" href="../theme/css/additional.css">
        
                <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "dark";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('dark')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../about_us.html">Về chúng tôi</a></li><li class="chapter-item expanded "><a href="../blogs/peak_finding.html" class="active">Thuật toán tìm đỉnh Peak Finding</a></li><li class="chapter-item "><a href="../blogs/sorting_algorithms.html">Các thuật toán sắp xếp cơ bản</a></li><li class="chapter-item "><a href="../blogs/binarysearch_tree.html">Cây tìm kiếm nhị phân</a></li><li class="chapter-item "><a href="../blogs/avl.html">Cây AVL, thuật toán sắp xếp AVL</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">TrL</h1>

                    <div class="right-buttons">
                                                                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="thuật-toán-tìm-đỉnh-peak-finding"><a class="header" href="#thuật-toán-tìm-đỉnh-peak-finding">Thuật toán tìm đỉnh Peak Finding</a></h1>
<head>
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600&display=swap" rel="stylesheet">
</head>
<div style="display: flex; align-items: center;">
<img style="width: 50px; border-radius: 50%; border: 1px solid #b71c1c" src="../images/us/tranlam.JPG" />
<span style="margin-left: 15px; color: #b71c1c;font-family: 'Cinzel', serif;">Tran Lam</span> <span style="margin-left: 15px;font-family: 'Cinzel', serif;">Feb 18,2021</span> <span style="margin-left: 15px;font-family: 'Cinzel', serif;" >7 min read</span>
</div>
<br/>
<p>Hôm nay mình sẽ nói về môt thuật toán cực kì cơ bản mà mình và hầu như các bạn bắt đầu học về lập trình thuật toán đều đã làm. Đó chính là thuật toán tìm đỉnh Peak Finding.</p>
<h3 id="các-đề-mục"><a class="header" href="#các-đề-mục">Các đề mục</a></h3>
<p><a href="#1-gi%E1%BB%9Bi-thi%E1%BB%87u-thu%E1%BA%ADt-to%C3%A1n">1. Giới thiệu thuật toán</a></p>
<p><a href="#2-t%C3%ACm-peak-trong-m%E1%BA%A3ng-1-chi%E1%BB%81u">2. Tìm peak trong mảng 1 chiều</a></p>
<p>     <a href="#21-c%C3%A1ch-1-duy%E1%BB%87t-tuy%E1%BA%BFn-t%C3%ADnh-linear-traversing">2.1. Cách 1: Duyệt tuyến tính (linear traversing)</a></p>
<p>     <a href="#22-c%C3%A1ch-2-duy%E1%BB%87t-nh%E1%BB%8B-ph%C3%A2n-binary-search">2.2. Cách 2: Duyệt nhị phân (binary search)</a></p>
<p><a href="#3-t%C3%ACm-peak-trong-m%E1%BA%A3ng-2-chi%E1%BB%81u">3. Tìm peak trong mảng 2 chiều</a></p>
<p>     <a href="#31-duy%E1%BB%87t-tr%E1%BB%B1c-ti%E1%BA%BFp">3.1. Duyệt trực tiếp</a></p>
<p>     <a href="#32-thu%E1%BA%ADt-to%C3%A1n-greedy-ascent">3.2. Thuật toán Greedy Ascent</a></p>
<p>     <a href="#33-thu%E1%BA%ADt-to%C3%A1n-jamming-binary-search">3.3. Thuật toán Jamming Binary Search</a></p>
<p><a href="#4-t%C3%A0i-li%E1%BB%87u-tham-kh%E1%BA%A3o">4. Tài liệu tham khảo</a></p>
<h3 id="1-giới-thiệu-thuật-toán"><a class="header" href="#1-giới-thiệu-thuật-toán">1. Giới thiệu thuật toán</a></h3>
<p>Trong một mảng, một số được gọi là một &quot;peak&quot; khi và chỉ khi các phần tử liền kề nó nhỏ hơn hoặc bằng phần tử được xét. Tưởng tượng rằng có một dãy núi như sau</p>
<div style="text-align:center;">
<img style="width: 70%;" src="../images/peak_finding/peaks.PNG" />
</div>
Các mũi tên đỏ ở trên trỏ đến các đỉnh (peak) của một dãy núi, vì các điểm đó cao hơn các điểm lân cận xung quanh nó (các điểm ở sườn núi).
<p>Để trực quan hơn trong lập trình, ta lấy ví dụ với mảng sau:</p>
<div style="text-align:center;">
<img style="width: 70%;" src="../images/peak_finding/1Darr.PNG" />
</div>
<p>Xét mảng các kí hiệu như trên, phần tử ở vị trí thứ 3 được gọi là một peak khi và chỉ khi <strong>\(c \ge b\)</strong> và <strong>\(c \ge d\)</strong>. Phần tử thứ 9 được gọi là một peak khi và chỉ khi <strong>\(i \ge h\)</strong>.</p>
<p>Chú ý rằng: </p>
<ul>
<li>Trong một mảng, sẽ luôn tồn tại ít nhất một peak.</li>
<li>Bài toán này của chúng ta sẽ là tìm một peak chứ không tìm tất cả các peak.</li>
</ul>
<h3 id="2-tìm-peak-trong-mảng-1-chiều"><a class="header" href="#2-tìm-peak-trong-mảng-1-chiều">2. Tìm peak trong mảng 1 chiều</a></h3>
<p>Giả sử ta có một mảng 1 chiều gồm <strong>\(n\)</strong> phần tử, tìm một peak của mảng đó.</p>
<h4 id="21-cách-1-duyệt-tuyến-tính-linear-traversing"><a class="header" href="#21-cách-1-duyệt-tuyến-tính-linear-traversing">2.1. Cách 1: Duyệt tuyến tính (linear traversing)</a></h4>
<p><strong>Ý tưởng:</strong> Duyệt qua từng phần tử của mảng và kiểm tra xem phần tử đang xét có thỏa mãn tính chất là một peak hay không.</p>
<p><strong>Phân tích thuật toán:</strong> Mỗi phần tử đang được duyệt sẽ có các câu lệnh điều kiện để kiểm tra xem phần tử đó có là peak, các câu lệnh điều kiện này tốn constant time \(\Theta(1)\). Trong trường hợp xấu nhất, ta sẽ phải duyệt hết tất cả <strong>\(n\)</strong> phần từ của mảng mới tìm được peak. Do vậy, worst case của thuật toán sẽ có time complexity là \(\Theta(n)\).</p>
<h4 id="22-cách-2-duyệt-nhị-phân-binary-search"><a class="header" href="#22-cách-2-duyệt-nhị-phân-binary-search">2.2. Cách 2: Duyệt nhị phân (binary search)</a></h4>
<p><strong>Ý tưởng:</strong> Trong cách này, ta sẽ luôn nhìn vào vị trí ở giữa của mảng được duyệt và quyết định xem ta sẽ duyệt nửa nào tiếp theo của mảng đó để tìm ra peak.</p>
<p><strong>Thuật toán:</strong> </p>
<ul>
<li>Nhìn vào vị trí \(\frac{n}{2}\).</li>
<li>Nếu \(a[\frac{n}{2}] \lt a[\frac{n}{2} - 1]\), ta nhìn vào nửa trái (các phần tử \(1, 2,...,\frac{n}{2} - 1)\) của mảng đang xét để tìm peak.</li>
<li>Nếu \(a[\frac{n}{2}] \lt a[\frac{n}{2} + 1]\), ta nhìn vào nửa phải (các phần tử \(\frac{n}{2} + 1, \frac{n}{2} + 2,..., n)\) của mảng đang xét để tìm peak.</li>
<li>Nếu không thỏa mãn cả 2 điều kiện trên, ta trả về phần tử vị trí \(\frac{n}{2}\) chính là một peak.</li>
</ul>
<p>Để giải thích cho điều này, mình có một hình vẽ để cho trực quan hơn</p>
<div style="text-align:center;">
<img style="width: 70%;" src="../images/peak_finding/1Dexp.PNG" />
</div>
<p>Mũi tên đỏ trỏ tới vị trí đang xét. Giả sử ta đang đứng trên một vị trí ở dãy núi, để ta có thể trèo lên đỉnh, ta sẽ luôn ngó sang bên mà ta thấy vị trí của nó cao hơn vị trí ta đang đứng, và đó cũng là thuật toán giải quyết cho bài toán này.</p>
<p><strong>Phân tích thuật toán:</strong> Sử dụng chia để trị (divide and conquer), ta có biểu thức sau</p>
<div style="text-align: center;">
<p>\(T(n) = T(\frac{n}{2}) + \Theta(1)\)</p>
</div>
<p>Time complexity cho các câu điều kiện so sánh \(\Theta(1)\), base case ở đây là \(T(1) = \Theta(1)\).
Từ đó, \(T(n) = \Theta(1) + \Theta(1) +...+ \Theta(1) = \Theta(log{_2}{n})\).</p>
<p><strong>Code Python</strong></p>
<pre><code class="language-python">import math
ini_arr = [10, 20, 15, 2, 23, 90, 67]

def peak_finding(arr):
    length = len(arr)
    middle = math.floor(length / 2)
    if length == 1:
        return arr[0]
    if length == 2:
        return arr[0] if (arr[0] &gt;= arr[1]) else arr[1]
    if arr[middle] &lt; arr[middle - 1]:
        return peak_finding(arr[:middle])
    elif arr[middle] &lt; arr[middle + 1]:
        return peak_finding(arr[middle + 1:])
    else:
        return arr[middle]


print(peak_finding(ini_arr))
</code></pre>
<p>Output</p>
<pre><code class="language-python">20
</code></pre>
<h3 id="3-tìm-peak-trong-mảng-2-chiều"><a class="header" href="#3-tìm-peak-trong-mảng-2-chiều">3. Tìm peak trong mảng 2 chiều</a></h3>
<p>Ta hình dung mảng 2 chiều <strong>\(m \times n\)</strong> được biểu diễn dưới dạng ma trận m hàng và n cột</p>
<div style="text-align:center;">
<img style="width: 70%;" src="../images/peak_finding/2Dmat.PNG">
</div>
<p>Một phần tử được coi là một peak khi và chỉ khi nó lớn hơn hoặc bằng tất cả các phần tử liền kề theo chiều dọc và ngang.</p>
<h4 id="31-duyệt-trực-tiếp"><a class="header" href="#31-duyệt-trực-tiếp">3.1. Duyệt trực tiếp</a></h4>
<p><strong>Ý tưởng:</strong> Duyệt qua từng phần tử của mảng và kiểm tra xem phần tử đang xét có thỏa mãn tính chất là một peak hay không.</p>
<p><strong>Phân tích thuật toán:</strong> worst case của thuật toán sẽ có time complexity là \(\Theta(m \times n)\).</p>
<h4 id="32-thuật-toán-greedy-ascent"><a class="header" href="#32-thuật-toán-greedy-ascent">3.2. Thuật toán Greedy Ascent</a></h4>
<p><strong>Ý tưởng:</strong> Chúng ta bắt đầu tại một điểm ngẫu nhiên. Với điểm đang xét, chúng ta so sánh nó với 4 điểm liền kề theo các chiều dọc và ngang, nếu có giá trị nào lớn hơn điểm đang xét, ta sẽ xét điểm tiếp theo là điểm đó.</p>
<p><strong>Phân tích thuật toán:</strong> Thoạt nghĩ qua thì ta thấy thuật toán có vẻ sẽ hiệu quả hơn, nhưng worst case của nó vẫn là \(\Theta(m \times n)\) khi mà ta phải duyệt phần lớn các phần tử.</p>
<h4 id="33-thuật-toán-jamming-binary-search"><a class="header" href="#33-thuật-toán-jamming-binary-search">3.3. Thuật toán Jamming Binary Search</a></h4>
<p><strong>Ý tưởng:</strong> Ta dựa trên cách tìm kiếm Binary Search như áp dụng với mảng một chiều ở trên.</p>
<p><strong>Thuật toán:</strong> </p>
<ul>
<li>Chọn cột ở giữa \(i = \frac{n}{2}\). Tìm giá trị lớn nhất của cột đó. Giả sử giá trị đó nằm ở vị trí \((j, i)\).</li>
<li>So sánh các phần tử ở vị trí \((j, i - 1), (j, i), (j, i + 1)\).</li>
<li>Ta chọn ma trận con phần bên trái nếu \(a[j, i - 1] \gt a[j, i]\), chọn ma trận con phần bên phải nếu \(a[j, i + 1] \gt a[j, i]\) để xét bước tiếp theo.</li>
<li>Nếu không, ta trả về giá trị \(a[j, i]\) là một peak.</li>
</ul>
<p><strong>Phân tích thuật toán:</strong> Base case ở đây sẽ là chúng ta chỉ có một cột duy nhất, tìm giá trị lớn nhất của cột đó. Từ đó, ta có biểu thức sau</p>
<div style="text-align: center;">
<p>\(T(m, n) = T(m, \frac{n}{2}) + \Theta(m) \)</p>
</div>
<p>Với \(T(m, 1) = \Theta(m)\).
Do vậy, \(T(m, n) = \Theta(m) + \Theta(m) +...+ \Theta(m) = \Theta(mlog{_2}{n})\).</p>
<p><strong>Code Python</strong></p>
<pre><code class="language-python">import numpy as np
import math
ini_matrix = np.array([[14, 13, 12, 6], [15, 9, 11, 7], [
                      16, 17, 19, 92], [17, 18, 17, 12]])

def peak_finding_2d(matrix):
    (rows, cols) = matrix.shape
    j = math.floor(cols / 2)
    i_in_max = np.argmax(matrix[:, j])
    if cols == 1:
        return matrix[i_in_max, j]
    if cols == 2:
        peak_1 = np.amax(matrix[:, 0])
        peak_2 = np.amax(matrix[:, 1])
        return peak_1 if peak_1 &gt;= peak_2 else peak_2
    if matrix[i_in_max, j] &lt; matrix[i_in_max, j-1]:
        return peak_finding_2d(matrix[:, :j])
    elif matrix[i_in_max, j] &lt; matrix[i_in_max, j+1]:
        return peak_finding_2d(matrix[:, (j+1):])
    else:
        return matrix[i_in_max, j]


print(peak_finding_2d(ini_matrix))
</code></pre>
<p>Output</p>
<pre><code class="language-python">92
</code></pre>
<br/>
<br/>
<br/>
<h3 id="4-tài-liệu-tham-khảo"><a class="header" href="#4-tài-liệu-tham-khảo">4. Tài liệu tham khảo</a></h3>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../about_us.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../blogs/sorting_algorithms.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../about_us.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../blogs/sorting_algorithms.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
